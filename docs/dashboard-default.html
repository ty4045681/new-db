<!DOCTYPE html>
<html lang="zh">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Modern, flexible and responsive Bootstrap 5 admin &amp; dashboard template">
	<meta name="author" content="Bootlab">

	<title>汽车维修管理系统</title>

	<!-- PICK ONE OF THE STYLES BELOW -->
	<!-- <link href="css/modern.css" rel="stylesheet"> -->
	<!-- <link href="css/classic.css" rel="stylesheet"> -->
	<!-- <link href="css/dark.css" rel="stylesheet"> -->
	<!-- <link href="css/light.css" rel="stylesheet"> -->

	<!-- BEGIN SETTINGS -->
	<!-- You can remove this after picking a style -->
	<style>
		body {
			opacity: 0;
		}
	</style>
	<script src="js/settings.js"></script>
	<!-- END SETTINGS -->
</head>

<body>
	<div class="splash active">
		<div class="splash-icon"></div>
	</div>

	<div class="wrapper">
		<nav id="sidebar" class="sidebar">
			<a class="sidebar-brand" href="index.html">
				<svg>
					<use xlink:href="#ion-ios-pulse-strong"></use>
				</svg>
				汽车维修管理系统
			</a>
			<div class="sidebar-content">
				<div class="sidebar-user">
					<img src="img/avatars/avatar-2.jpg" class="img-fluid rounded-circle mb-2" alt="Linda Miller" />
					<div class="fw-bold">邱文杰</div>

				</div>

				<ul class="sidebar-nav">
					<li class="sidebar-header">
						
					</li>
					<li class="sidebar-item active">
						<a data-bs-target="#dashboards" data-bs-toggle="collapse" class="sidebar-link">
							<i class="align-middle me-2 fas fa-fw fa-home"></i> <span class="align-middle">主界面</span>
						</a>
						<!-- <ul id="dashboards" class="sidebar-dropdown list-unstyled collapse show" data-bs-parent="#sidebar">
							<li class="sidebar-item active"><a class="sidebar-link" href="dashboard-default.html">Default</a></li>
							<li class="sidebar-item"><a class="sidebar-link" href="dashboard-analytics.html">Analytics</a></li>
							<li class="sidebar-item"><a class="sidebar-link" href="dashboard-e-commerce.html">E-commerce</a></li>
						</ul> -->
					</li>
				</ul>
			</div>
		</nav>
		<div class="main">
			<nav class="navbar navbar-expand navbar-theme">
				<a class="sidebar-toggle d-flex me-2">
					<i class="hamburger align-self-center"></i>
				</a>

				<form class="d-none d-sm-inline-block">
					<input class="form-control form-control-lite" type="text" placeholder="搜索项目...">
				</form>

				<div class="navbar-collapse collapse">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item dropdown ms-lg-2">
							<a class="nav-link dropdown-toggle position-relative" href="#" id="userDropdown" data-bs-toggle="dropdown">
								<i class="align-middle fas fa-cog"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
								<a class="dropdown-item" href="#"><i class="align-middle me-1 fas fa-fw fa-user"></i> View Profile</a>
								<a class="dropdown-item" href="#"><i class="align-middle me-1 fas fa-fw fa-comments"></i> Contacts</a>
								<a class="dropdown-item" href="#"><i class="align-middle me-1 fas fa-fw fa-chart-pie"></i> Analytics</a>
								<a class="dropdown-item" href="#"><i class="align-middle me-1 fas fa-fw fa-cogs"></i> Settings</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="#"><i class="align-middle me-1 fas fa-fw fa-arrow-alt-circle-right"></i> Sign out</a>
							</div>
						</li>
					</ul>
				</div>

			</nav>
			<main class="content">
				<div class="container-fluid">

					<div class="header">
						<h1 class="header-title">
							欢迎登录
						</h1>
					</div>

					<form id="smartwizard-validation" class="wizard wizard-primary mb-4 sw sw-theme-default sw-justified" action="javascript:void(0)" novalidate="novalidate">
						<ul class="nav">
							<li class="nav-item"><a class="nav-link inactive active" href="#validation-step-1">第一步<br>登记信息</a>
							</li>
							<li class="nav-item"><a class="nav-link inactive" href="#validation-step-2">第二步<br>维修委托书</a>
							</li>
							<li class="nav-item"><a class="nav-link inactive" href="#validation-step-3">第三步<br>维修派工单</a>
							</li>
							<li class="nav-item"><a class="nav-link inactive" href="#validation-step-4">第四步<br>总费用</a>
							</li>
						</ul>
						
						<div class="tab-content">
							<div id="validation-step-1" class="tab-pane" role="tabpanel">
								<div class="col-md-12">
									<div class="card">
										<div class="card-header">
											<h3 class="card-title">
												<i class="fas fa-chart-bar"></i>
												客户及车辆信息
											</h3>
										</div>
										<div class="card-body">
											<div class="form-group">
												<h4>客户信息</h4>
												<hr class="bg-primary border-2 border-top border-primary">
												<div class="row">
													<div class="mb-3 col-md-3">
														<label for="inputCustomID">客户编号
															<span class="text-danger">*</span>
														</label>
														<input type="text" class="form-control required is-invalid" id="InputCustomID" placeholder="客户编号">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCustomName">客户名称
															<span class="text-danger">*</span>
														</label>
														<input type="text" class="form-control required is-invalid" id="InputCustomName" placeholder="客户名称">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCustomType">客户性质</label>
														<select class="form-control select2" data-bs-toggle="select2" id="InputCustomType">
															<!-- <option value="-1">请选择</option> -->
															<option value="1">单位</option>
															<option value="2">个人</option>
														</select>
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputDiscountRate">折扣率
															<span class="text-danger">*</span>
														</label>
														<input type="number" class="form-control required" id="InputDiscountRate" min=0 max=1 step="0.1" placeholder="折扣率">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCustomContact">联系人
															<span class="text-danger">*</span>
														</label>
														<input type="text" class="form-control required" id="InputCustomContact" placeholder="联系人">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCustomPhone">联系电话
															<span class="text-danger">*</span>
														</label>
														<input type="text" inputmode="numeric" class="form-control required is-invalid" id="InputCustomPhone" placeholder="联系电话">
													</div>
												</div>
												<h4>车辆信息</h4>
												<hr class="bg-primary border-2 border-top border-primary">
												<div class="row">
													<div class="mb-3 col-md-3">
														<label for="inputCarID">车牌号
															<span class="text-danger">*</span>
														</label>
														<input type="text" class="form-control required is-invalid" id="InputCarID" placeholder="车牌号">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCarColor">车辆颜色
															<span class="text-danger">*</span>
														</label>
														<input type="text" class="form-control required is-invalid" id="inputCarColor" placeholder="车辆颜色">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCarModel">车辆型号
															<span class="text-danger">*</span> 
														</label>
														<input type="text" class="form-control required" id="InputCarModel" placeholder="车辆型号">
													</div>
													<div class="mb-3 col-md-3">
														<label for="inputCarType">车辆类别</label>
														<select class="form-control select2" data-bs-toggle="select2" id="InputCarType">
															<!-- <option value="-1">请选择</option> -->
															<option value="1">客车</option>
															<option value="2">微型车</option>
															<option value="3">小型车</option>
															<option value="4">大型车</option>
														</select>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-md-12">
									<form>
										<div class="card">
											<div class="card-header">
												<h3 class="card-title">维修信息</h3>
											</div>
											<div class="card-body">
												<div class="form-group">
													<div class="row">
														<div class="mb-3 col-md-3">
															<label for="inputRepairType">维修类型</label>
															<select class="form-control select2" data-bs-toggle="select2" id="InputRepairType">
																<!-- <option value="-1">请选择</option> -->
																<option value="1">普通</option>
																<option value="2">保养</option>
															</select>
														</div>
														<div class="mb-3 col-md-3">
															<label for="inputWorkType">作业分类</label>
															<select class="form-control select2" data-bs-toggle="select2" id="InputWorkType">
																<!-- <option value="-1">请选择</option> -->
																<option value="1">小修</option>
																<option value="2">中修</option>
																<option value="3">大修</option>
															</select>
														</div>
														<div class="mb-3 col-md-3">
															<label for="inputPaymentMethod">结算方式</label>
															<select class="form-control select2" data-bs-toggle="select2" id="InputPaymentMethod">
																<!-- <option value="-1">请选择</option> -->
																<option value="1">现金</option>
																<option value="2">刷卡</option>
																<option value="3">支票</option>
																<option value="4">汇款</option>
															</select>
														</div>
														<div class="mb-3 col-md-3">
															<label for="inputFaultDescription">故障描述
																<span class="text-danger">*</span>
															</label>
															<input type="text" class="form-control required" id="InputFaultDescription" placeholder="故障描述">
														</div>
														<div class="mb-3 col-md-3">
															<label for="inputTime">进场时间
																<span class="text-danger">*</span>
															</label>
															<div class="input-group date" id="InputTime" data-target-input="nearest">
																<input type="text" class="form-control datetimepicker-input" data-target="#InputTime" id="date">
																<div class="input-group-text" data-target="#InputTime" data-toggle="datetimepicker">
																	<i class="fa fa-calendar"></i>
																</div>
																<br>
																<span class="font-13 text-muted">e.g "DD/MM/YYYY HH:MM AM/PM"</span>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</form>	
								</div>
							</div>

							<div id="validation-step-2" class="tab-pane" role="tabpanel">
								<table class="table">
									<tr>
										<th class="table-primary" scope="row">车牌号</th>
										<td class="table-default" scope="row" id="CarID"></td>
										<th class="table-primary" scope="row">客户编号</th>
										<td class="table-default" scope="row" id="CustomID"></td>
										<th class="table-primary" scope="row">维修类型</th>
										<td class="table-default" scope="row" id="RepairType"></td>
									</tr>
									<tr>
										<th class="table-primary" scope="row">作业分类</th>
										<td class="table-default" scope="row" id="WorkType"></td>
										<th class="table-primary" scope="row">结算方式</th>
										<td class="table-default" scope="row" id="PaymentMethod"></td>
										<th class="table-primary" scope="row">进场时间</th>
										<td class="table-default" scope="row" id="Time"></td>
									</tr>
									<tr>
										<th class="table-primary" scope="row">业务员</th>
										<td class="table-default" scope="row" id="ClerkName"></td>
										<th class="table-primary" scope="row">业务员编号</th>
										<td class="table-default" scope="row" id="ClerkID"></td>
										<th class="table-primary" scope="row">预计完工时间</th>
										<td class="table-default" scope="row" id="FinishTime"></td>
									</tr>
								</table>
								<table class="table">
									<tr>
										<th class="table-primary text-center" scope="row">故障描述</th>
									</tr>
								</table>
								<table class="table">
									<td id="FaultDescription"></td>
								</table>
							</div>
							
							<div id="validation-step-3" class="tab-pane" role="tabpanel">
								<div class="card-body">
									<div id="datatable", class="dataTables_wrapper dt-bootstrap5 no-footer">
										<div class="row">
											<div class="col-sm-12 col-md-6">
												<div class="dt-buttons btn-group flex-wrap">
													<button class="btn btn-secondary buttons-copy buttons-html5" tabindex="0" aria-controls="datatables-buttons" type="button">
														<span>复制</span>
													</button>
													<div class="modal fade" id="database-search" tabindex="-1" aria-labelledby="exampleModalCenteredScrollableTitle" style="display: none;" aria-hidden="true">
														<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
															<div class="modal-content">
																<div class="modal-header">
																	<h5 class="modal-title" id="datatable-search-header">选择维修项目</h5>
																	<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
																</div>
																<div class="modal-body">
																	<p>选择维修项目</p>
																	<form method="post">
																		<div class="dataTables_wrapper" id="table-wrapper">
																			<div class="dataTables_length" id="table_length">
																				<label>显示 
																					<select name="table_length" aria-controls="table" class>
																						<option value="10">10</option>
																						<option value="25">25</option>
																						<option value="50">50</option>
																						<option value="100">100</option>
																					</select>
																					 项
																				</label>
																			</div>
																			<div id="table_filter" class="dataTables_filter">
																				<label>搜索
																					<input type="search" class placeholder aria-controls="table">
																				</label>
																			</div>
																			<div id="wrapper">
																				<table id="table" class="display nowrap dataTable dtr-inline collapsed" style="width: 100%;" aria-describedby="table_info">
																					<thead>
																						<tr>
																							<th>选择</th>
																							<th class="sorting sorting_asc" tabindex="0" aria-controls="table" rowspan="1" colspan="1" style="width: 120px;" aria-sort="ascending" aria-label="Name: activate to sort column descending">维修项目编号</th>
																							<th class="sorting" tabindex="0" aria-controls="table" rowspan="1" colspan="1" style="width: 189px;" aria-label="Position: activate to sort column ascending">维修项目</th>
																							<th class="sorting" tabindex="0" aria-controls="table" rowspan="1" colspan="1" style="width: 89px;" aria-label="Office: activate to sort column ascending">工时</th>
																							<th class="dt-body-right sorting" tabindex="0" aria-controls="table" rowspan="1" colspan="1" style="width: 35px;" aria-label="Age: activate to sort column ascending">维修员编号</th>
																							<th class="sorting" tabindex="0" aria-controls="table" rowspan="1" colspan="1" style="width: 80px;" aria-label="Start date: activate to sort column ascending">维修员工种</th>
																						</tr>
																					</thead>
	
																					<tbody>
																						<div class="form">
																							<td>
																								<label class="checkbox-wrap checkbox-primary">
																									<input class="form-check-input" type="checkbox" value="1" id="check" checked>
																								<span class="checkmark"></span>
																								</label>
																							</td>
																							<td tabindex="0">012</td>
																							<td>维修车头</td>
																							<td>5</td>
																							<td>012</td>
																							<td>机修</td>
																						</div>
																					</tbody>
																				</table>
																			</div>
																		</div>
																	</form>
																</div>
																<div class="modal-footer">
																	<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
																	<button type="button" class="btn btn-primary" id="save" data-bs-dismiss="modal">保存修改</button>
																</div>
															</div>
														</div>
													</div>
													<button class="btn btn-secondary buttons-search" tabindex="1" aria-controls="datatables-buttons" type="button" data-bs-toggle="modal" data-bs-target="#database-search">
														<span>搜索</span>
													</button>

													<div class="table" id="confirmedtable">

													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div id="validation-step-4" class="tab-pane" role="tabpanel">
								<p>总费用：500元</p>
							</div>
						</div>
					</form>
				</div>
			</main>
			<footer class="footer">
				<div class="container-fluid">
					<div class="text-end">
						<p class="mb-0">
							&copy; 2022 - <a href="dashboard-default.html" class="text-muted">汽车维修管理系统</a>
						</p>
					</div>
				</div>
			</footer>
		</div>

	</div>

	<svg width="0" height="0" style="position:absolute">
		<defs>
			<symbol viewBox="0 0 512 512" id="ion-ios-pulse-strong">
				<path
					d="M448 273.001c-21.27 0-39.296 13.999-45.596 32.999h-38.857l-28.361-85.417a15.999 15.999 0 0 0-15.183-10.956c-.112 0-.224 0-.335.004a15.997 15.997 0 0 0-15.049 11.588l-44.484 155.262-52.353-314.108C206.535 54.893 200.333 48 192 48s-13.693 5.776-15.525 13.135L115.496 306H16v31.999h112c7.348 0 13.75-5.003 15.525-12.134l45.368-182.177 51.324 307.94c1.229 7.377 7.397 11.92 14.864 12.344.308.018.614.028.919.028 7.097 0 13.406-3.701 15.381-10.594l49.744-173.617 15.689 47.252A16.001 16.001 0 0 0 352 337.999h51.108C409.973 355.999 427.477 369 448 369c26.511 0 48-22.492 48-49 0-26.509-21.489-46.999-48-46.999z">
				</path>
			</symbol>
		</defs>
	</svg>
	<script src="js/app.js"></script>
	
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			$(".select2").each(function( index ) {
				$(this)
					.wrap("<div class=\"position-relative\"></div>")
					.select2({
						placeholder: "请选择",
						dropdownParent: $(this).parent()
					});
			});
			$("#InputTime").datetimepicker();
			var $validationForm = $("#smartwizard-validation");
			$validationForm.validate({
				errorPlacement: function errorPlacement(error, element) {
					$(element).parents(".error-placeholder").append(
						error.addClass("invalid-feedback small d-block")
					)
				},
				highlight: function(element) {
					$(element).addClass("is-invalid");
				},
				unhighlight: function(element) {
					$(element).removeClass("is-invalid");
				},
				// rules: {
				// 	"wizard-confirm": {
				// 		equalTo: "input[name=\"wizard-password\"]"
				// 	}
				// }
			});
			$validationForm
				.smartWizard({
					autoAdjustHeight: true,
					backButtonSupport: false,
					useURLhash: false,
					showStepURLhash: false,
					toolbarSettings: {
						toolbarExtraButtons: [$("<button class=\"btn btn-submit btn-primary\" type=\"button\">完成</button>")]
					},
					lang: { 
						next: '下一步',
						previous: '上一步',
					},

				})
				.on("leaveStep", function(e, anchorObject, stepNumber, stepDirection) {
					if (stepDirection === 1) {
						return $validationForm.valid();
					}
					return true;
				});
			$validationForm.on("stepContent", function(e, anchorObject, stepIndex, stepDirection) {
				// $(".table-primary").append("Step " + (stepIndex + 1));
				if (stepIndex === 1) {
					$("#CarID").text($("#InputCarID").val());
					$("#CustomID").text($("#InputCustomID").val());
					$("#RepairType").text($("#InputRepairType").find("option")[parseInt($("#InputRepairType").val()) - 1].text);
					$("#WorkType").text($("#InputWorkType").find("option")[parseInt($("#InputWorkType").val()) - 1].text);
					$("#PaymentMethod").text($("#InputPaymentMethod").find("option")[parseInt($("#InputPaymentMethod").val()) - 1].text);
					$("#Time").text($("#date").val());
					$("#FaultDescription").text($("#InputFaultDescription").val());
				}
				
			})
			$validationForm.find(".btn-submit").on("click", function() {
				if (!$validationForm.valid()) {
					return;
				}
				const pool = new Pool(config)
				pool.query(`INSERT INTO customers VALUES (${CustomerId}, ${CustomerName},${CustomerType},${Discount},${Linkman},${Phone});
							INSERT INTO cars VALUES (${CarID}, ${CarColor}, ${CarModel}, ${CarType},${CustomerId}); 
							INSERT INTO entrust VALUES (${EntrustId},${CarId},${RepairType},${WorkType},${PayType},${CheckTime},${RepairTime},${FinishTime},${ClerkId}, ${Description});
							INSERT INTO work VALUES (${EntrustId},)`, (err, res) => {
					pool.end()
				})
				alert("已完成");
				return false;
			});
			$validationForm.find(".btn btn-secondary buttons-search").on("click", function() {
				pool.query(`SELECT * FROM items; SELECT * FROM repairmen`, (err, res) => {
					$("#Table").innerHTML = res;
					pool.end()
				})
			});
			$validationForm.find("#save").on("click", function() {
				var first = document.getElementById("wrapper");
				var second = document.getElementById("confirmedtable");
				if ($("#check").val() === "checked") {
					second.innerHTML = first.innerHTML;
				}
			});
		});
		
	</script>
	<script>
	</script>
	<script>
		$(function() {
			$('#datetimepicker-dashboard').datetimepicker({
				inline: true,
				sideBySide: false,
				format: 'L'
			});
		});
	</script>

</body>

</html>